---
export interface Props {
  content?: any;
  className?: string;
}

const { content, className = "" } = Astro.props;

// Function to render Tina rich text content
function renderRichText(content: any): string {
  if (!content) return '';

  if (typeof content === 'string') {
    return content;
  }

  if (Array.isArray(content)) {
    return content.map(item => renderRichText(item)).join('');
  }

  if (content.type === 'root') {
    return content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
  }

  if (content.type === 'p') {
    const innerContent = content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
    return `<p class="mb-6 leading-relaxed text-gray-700">${innerContent}</p>`;
  }

  if (content.type === 'h2') {
    const innerContent = content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
    return `<h2 class="text-3xl md:text-4xl font-display font-bold text-gray-900 mb-6 mt-12">${innerContent}</h2>`;
  }

  if (content.type === 'h3') {
    const innerContent = content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
    return `<h3 class="text-2xl md:text-3xl font-display font-bold text-gray-800 mb-4 mt-10">${innerContent}</h3>`;
  }

  if (content.type === 'h4') {
    const innerContent = content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
    return `<h4 class="text-xl md:text-2xl font-display font-bold text-gray-700 mb-3 mt-8">${innerContent}</h4>`;
  }

  if (content.type === 'ul') {
    const innerContent = content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
    return `<ul class="list-none space-y-3 mb-6 pl-0">${innerContent}</ul>`;
  }

  if (content.type === 'ol') {
    const innerContent = content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
    return `<ol class="list-decimal list-outside space-y-3 mb-6 pl-6">${innerContent}</ol>`;
  }

  if (content.type === 'li') {
    const innerContent = content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
    return `<li class="relative pl-6 before:content-['•'] before:absolute before:left-0 before:top-0 before:text-naranja-vibrante before:text-xl before:font-bold">${innerContent}</li>`;
  }

  if (content.type === 'strong') {
    const innerContent = content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
    return `<strong class="font-bold text-gray-900">${innerContent}</strong>`;
  }

  if (content.type === 'em') {
    const innerContent = content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
    return `<em class="italic text-gray-700">${innerContent}</em>`;
  }

  if (content.type === 'a') {
    const innerContent = content.children ? content.children.map((child: any) => renderRichText(child)).join('') : '';
    const href = content.url || '#';
    return `<a href="${href}" class="text-naranja-vibrante font-medium underline decoration-2 underline-offset-2 transition-all duration-200 hover:text-orange-700 hover:decoration-4 hover:underline-offset-4">${innerContent}</a>`;
  }

  if (content.type === 'text') {
    return content.text || '';
  }

  // Default fallback
  if (content.children) {
    return content.children.map((child: any) => renderRichText(child)).join('');
  }

  return '';
}

const renderedContent = renderRichText(content);
---

{content && (
  <section class={`rich-text-section py-16 bg-white ${className}`}>
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="rich-text-content prose prose-lg max-w-none" set:html={renderedContent} />
    </div>
  </section>
)}

<style>
  /* Additional styling for rich text content */
  .rich-text-content ul li::before {
    content: '•';
    color: var(--naranja-vibrante);
    font-weight: bold;
    position: absolute;
    left: 0;
    top: 0;
    font-size: 1.25rem;
  }

  .rich-text-content ul li {
    position: relative;
    padding-left: 1.5rem;
  }

  .rich-text-content ol li {
    padding-left: 0.5rem;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .rich-text-content h2 {
      font-size: 2rem;
    }

    .rich-text-content h3 {
      font-size: 1.75rem;
    }

    .rich-text-content h4 {
      font-size: 1.5rem;
    }
  }
</style>