---
import Header from '../components/Header.astro'
import Footer from '../components/Footer.astro'
import '../styles/global.css'

export interface Props {
  title: string
  description?: string
  canonical?: string
  image?: string
}

const { title, description = "Servicios profesionales de redacción SEO para impulsar tu negocio online", canonical, image } = Astro.props

// Añadir automáticamente " - RedactorSEO.es" al título si no lo tiene ya
const fullTitle = title.includes('RedactorSEO.es') ? title : `${title} - RedactorSEO.es`

// Canonical URL - usar la proporcionada o construir desde URL actual
const canonicalURL = canonical || new URL(Astro.url.pathname, Astro.site).href

// Open Graph image - usar la proporcionada o usar imagen por defecto
const ogImage = image || new URL('/og-image.jpg', Astro.site).href
---

<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="canonical" href={canonicalURL} />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={fullTitle} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage} />
    <meta property="og:locale" content="es_ES" />
    <meta property="og:site_name" content="RedactorSEO.es" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalURL} />
    <meta name="twitter:title" content={fullTitle} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />

    <!-- Preconnect to external origins for faster network requests -->
    <link rel="preconnect" href="https://redactor-seo-counter.dawn-smoke-fbd0.workers.dev" crossorigin />

    <!-- Preload critical fonts for optimal performance -->
    <link rel="preload" href="/fonts/inter-400.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/fonts/inter-600.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/fonts/inter-700.woff2" as="font" type="font/woff2" crossorigin />

    <!-- Plausible Analytics with proxy -->
    <script defer data-api="/api/event" data-domain="redactorseo.es" src="/js/script.js"></script>

    <!-- Favicon optimized -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />

    <title>{fullTitle}</title>

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@graph": [
          {
            "@type": "Organization",
            "@id": "https://redactorseo.es/#organization",
            "name": "Redactor SEO",
            "url": "https://redactorseo.es",
            "description": "Servicios profesionales de redacción SEO y copywriting",
            "email": "info@redactorseo.es",
            "founder": {
              "@id": "https://redactorseo.es/sobre-mi#person"
            },
            "address": {
              "@type": "PostalAddress",
              "addressCountry": "ES"
            },
            "areaServed": {
              "@type": "Country",
              "name": "España"
            }
          },
          {
            "@type": "WebSite",
            "@id": "https://redactorseo.es/#website",
            "url": "https://redactorseo.es",
            "name": "Redactor SEO",
            "description": "Servicios profesionales de redacción SEO",
            "publisher": {
              "@id": "https://redactorseo.es/#organization"
            },
            "inLanguage": "es-ES"
          },
          {
            "@type": "ProfessionalService",
            "@id": "https://redactorseo.es/#service",
            "name": "Redactor SEO",
            "description": "Servicios profesionales de redacción web, SEO y copywriting",
            "url": "https://redactorseo.es",
            "provider": {
              "@id": "https://redactorseo.es/#organization"
            },
            "email": "info@redactorseo.es",
            "address": {
              "@type": "PostalAddress",
              "addressCountry": "ES",
              "addressRegion": "España"
            },
            "priceRange": "450-2350 EUR",
            "areaServed": {
              "@type": "Country",
              "name": "España"
            },
            "serviceType": ["Redacción SEO", "Copywriting", "Content Marketing"],
            "hasOfferCatalog": {
              "@type": "OfferCatalog",
              "name": "Servicios de Redacción SEO",
              "itemListElement": [
                {
                  "@type": "Offer",
                  "itemOffered": {
                    "@type": "Service",
                    "name": "Redacción Web",
                    "description": "Redacción de páginas web que conectan y convierten",
                    "url": "https://redactorseo.es/redaccion-web"
                  },
                  "price": "1450",
                  "priceCurrency": "EUR"
                },
                {
                  "@type": "Offer",
                  "itemOffered": {
                    "@type": "Service",
                    "name": "Redacción Blog",
                    "description": "Contenido de blog que posiciona como referente",
                    "url": "https://redactorseo.es/redaccion-blog"
                  },
                  "price": "450",
                  "priceCurrency": "EUR",
                  "priceSpecification": {
                    "@type": "UnitPriceSpecification",
                    "price": "450",
                    "priceCurrency": "EUR",
                    "referenceQuantity": {
                      "@type": "QuantitativeValue",
                      "value": "1",
                      "unitCode": "MON"
                    }
                  }
                },
                {
                  "@type": "Offer",
                  "itemOffered": {
                    "@type": "Service",
                    "name": "Pack Inevitable",
                    "description": "Web completa + Blog estratégico",
                    "url": "https://redactorseo.es/pack-inevitable"
                  },
                  "price": "2350",
                  "priceCurrency": "EUR"
                }
              ]
            },
            "contactPoint": {
              "@type": "ContactPoint",
              "contactType": "Customer Service",
              "email": "info@redactorseo.es",
              "availableLanguage": ["Spanish"]
            }
          }
        ]
      }
    </script>

    <!-- Critical CSS inline for immediate rendering - Comprehensive above-the-fold styles -->
    <style>
      /* Self-hosted fonts for optimal performance and privacy - cached by Cloudflare */
      @font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url('/fonts/inter-400.woff2') format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}
      @font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url('/fonts/inter-600.woff2') format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}
      @font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url('/fonts/inter-700.woff2') format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}

      /* Reset and base styles */
      *,::before,::after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}
      ::before,::after{--tw-content:''}
      html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;font-feature-settings:normal;font-variation-settings:normal}
      body{margin:0;line-height:inherit;background:white;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}

      /* Header critical styles */
      header{background:white;box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1)}
      nav{max-width:80rem;margin:0 auto;padding:1.5rem 1rem;display:flex;justify-content:space-between;align-items:center}
      .logo{display:flex;align-items:center}
      .nav-links{display:none}
      @media (min-width:768px){.nav-links{display:flex;space-x:2rem}}

      /* Hero section critical */
      #hero{position:relative;padding:4rem 1rem;background:white;overflow:hidden}
      @media (min-width:768px){#hero{padding:5rem 1rem}}
      @media (min-width:1024px){#hero{padding:6rem 3rem}}

      /* Background elements */
      .hero-bg-1{position:absolute;top:5rem;right:5rem;width:10rem;height:10rem;background:#f9fafb;border-radius:50%;z-index:-1}
      .hero-bg-2{position:absolute;bottom:8rem;left:4rem;width:6rem;height:6rem;background:rgba(229,90,46,0.05);border-radius:50%;z-index:-1}

      /* Hero container */
      .hero-container{position:relative;width:100%;max-width:64rem;margin:0 auto;text-align:center}

      /* Subtitle critical */
      .hero-subtitle{margin-bottom:1.5rem;margin-top:1rem;text-transform:uppercase;font-size:.875rem;font-weight:500;letter-spacing:.05em;color:#6b7280}
      @media (min-width:1024px){.hero-subtitle{margin-bottom:2rem;margin-top:2rem}}

      /* Google text critical */
      .hero-google{display:block;font-size:6rem;margin-bottom:1.5rem;font-weight:700;line-height:1;letter-spacing:-.025em}
      @media (min-width:640px){.hero-google{font-size:7rem}}
      @media (min-width:768px){.hero-google{font-size:8rem}}
      @media (min-width:1024px){.hero-google{font-size:8rem}}
      @media (min-width:1280px){.hero-google{font-size:9rem}}

      /* Years critical */
      .hero-years{display:block;font-size:1.125rem;color:#6b7280;font-weight:300;letter-spacing:.05em;margin:1.5rem 0}
      @media (min-width:640px){.hero-years{font-size:1.25rem}}
      @media (min-width:768px){.hero-years{font-size:1.5rem}}
      @media (min-width:1024px){.hero-years{font-size:1.875rem}}

      /* DEP critical */
      .hero-dep{display:block;font-size:7rem;color:#1f2937;font-weight:700;letter-spacing:-.05em;margin-bottom:2rem;line-height:1}
      @media (min-width:640px){.hero-dep{font-size:8rem}}
      @media (min-width:768px){.hero-dep{font-size:9rem}}
      @media (min-width:1024px){.hero-dep{font-size:9rem;margin-bottom:3rem}}
      @media (min-width:1280px){.hero-dep{font-size:8rem}}

      /* Google colors critical */
      .g1{color:#4285F4} .o1{color:#EA4335} .o2{color:#FBBC04} .g2{color:#4285F4} .l{color:#34A853} .e{color:#EA4335}

      /* Button critical */
      .hero-btn{background:#1f2937;color:white;padding:1rem 2rem;border-radius:.5rem;border:2px solid #1f2937;font-weight:500;font-size:1.125rem;cursor:pointer;display:inline-block;margin:1rem 0;text-decoration:none}
      .hero-btn:hover{background:#374151;border-color:#374151}

      /* Counter critical */
      .hero-counter{color:#6b7280;font-size:1.125rem;display:flex;align-items:center;justify-content:center;gap:.5rem;margin:1rem 0}

      /* Utility classes */
      .relative{position:relative}
      .absolute{position:absolute}
      .inset-0{top:0;right:0;bottom:0;left:0}
      .block{display:block}
      .flex{display:flex}
      .items-center{align-items:center}
      .justify-center{justify-content:center}
      .text-center{text-align:center}
      .mx-auto{margin-left:auto;margin-right:auto}
      .w-full{width:100%}
      .bg-white{background-color:white}
      .overflow-hidden{overflow:hidden}
      .mb-2{margin-bottom:.5rem}
      .mb-4{margin-bottom:1rem}
      .mb-6{margin-bottom:1.5rem}
      .mb-8{margin-bottom:2rem}
      .gap-2{gap:.5rem}
      .px-4{padding-left:1rem;padding-right:1rem}
      .py-16{padding-top:4rem;padding-bottom:4rem}
      @media (min-width:640px){.sm\\:px-6{padding-left:1.5rem;padding-right:1.5rem}}
      @media (min-width:768px){.md\\:py-20{padding-top:5rem;padding-bottom:5rem}}
      @media (min-width:1024px){.lg\\:px-12{padding-left:3rem;padding-right:3rem};.lg\\:py-24{padding-top:6rem;padding-bottom:6rem}}
      @media (min-width:1280px){.xl\\:px-16{padding-left:4rem;padding-right:4rem}}

      /* Hide non-critical content initially */
      .lazy-load{opacity:0;visibility:hidden}
    </style>

    <!-- Optimized lazy load reveal - defer execution -->
    <script>
      // Reveal lazy content after DOMContentLoaded with minimal overhead
      document.addEventListener('DOMContentLoaded',()=>{document.querySelectorAll('.lazy-load').forEach(el=>{el.style.cssText='opacity:1;visibility:visible;transition:opacity .3s ease'})});
    </script>

    <slot name="head" />
  </head>
  <body class="bg-white font-body">
    <Header />
    <main>
      <slot />
    </main>
    <Footer />
  </body>
</html>